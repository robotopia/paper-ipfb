Dear editor & referee,

We would like to thank both of you for encouraging us to look more deeply into the justification of the synthesis filter that we were using. The result has been not only an improved paper (hopefully!) but also an improved system. We found it interesting to compare the performance of different kinds of filters, and hope that the extra rigour we've inserted into the "Synthesis filters" section will be acceptable to the referee and useful to the readers. On account of the extra work, several sections of the paper have been completely rewritten, as described below in the detailed comments.

----------------------------

Referee: This paper present a method for inversion of the 2nd-stage (fine) PFB on data recorded with the Murchison Widefield Array's Voltage Capture System, in order to recover high time resolution instead of the VCS' nominal fine (10kHz) frequency resolution. The authors demonstrate the performance on a trio of pulsars with known short-timescale emission structure. I appreciate very much the effort the authors went to to write up this work, and generally feel that more papers of this sort, covering signal analyses suitable suitable to radio observations, are needed in the literature. Unfortunately, as it stands, I don't see the novelty or scientific impact of this work, and cannot recommend it for publication in a peer-reviewed science journal. I strongly encourage the authors to flesh out their derivations, to justify and characterize the implementation more quantitatively, and re-submit. Detailed comments follow.

Referee: The paper begins with a concise review of PFBs. An overview of synthesis filters used to reverse their operation is given, and the problem is overall well motived. I applaud the authors for laying out the task so clearly.

Referee: The specific choice of synthesis filter, however, seems completely unmotivated and unjustified in any quantitative sense. The authors seem to simply argue "good enough is good enough," but for the central point of the paper I find this woefully insufficient, particularly when well-justified formulations are easily found online and in the community. A quick google reveals https://github.com/jrs65/pfb-inverse as the top result, where a least-squares solution to the inversion is presented. It appears to operate offline, but solves the artefacts described in this work. If the authors require realtime inversion to make it a part of the MWA VCS pipeline, computationally inexpensive solutions exist which vastly reduce the temporal echoes they see. Given that such solutions are in the community already, I would expect at minimum some proof of optimality for some well-chosen metric.

Authors: In hindsight, we completely agree that a paper such as this, if it does not attempt to provide a proper justification for the choice of synthesis filter, cannot possibly offer any value to the radio astronomy community who might be interested in replicating, or improving upon, our method. Accordingly, we investigated the least-squares solution that the referee recommended, and have provided a full, quantitative comparison of a multiple synthesis filters, including our original "mirror" filter and a few least-squares solutions of different lengths. In so doing, we inevitably found that the least-squares solution performs better than our original filter, and we provide a metric (with accompanying derivation) for comparing them.

I was glad to see the impulse response to characterize performance, but the comparison to an ifft seems silly except to point out that one should not expect iffts to invert pfbs.

The pulsar observations constitute a nice proof-of-concept, and serve as demonstrations of the chosen filter in the field as the authors do not pursue them to novel results. I do not understand the comparison of incoherently- to coherently-dedispersed profiles, it seems very much apples-to-oranges and not directly relevant to the variable time/freq division of the data. The time-resolved sub-pulse microstructure of B0950+08, however, is an impressive demonstration, well worth including in a revised paper.

Lastly, I would be remiss if I didn't express some concern that the PFB implemented on the FPGAs cannot be exactly reproduced on general-purpose compute hardware! The difference in hardware can hardly matter for a digital operation, and myriad libraries exist to implement arbitrary bit-depth arithmetic in CPUs. It's clear from the properties presented in appendix A that a number of awkward features are already reproduced, and I'd strongly encourage the authors to find an FFT implementation (or implement one themselves) which perfectly mimics that on the FPGA.

I'll close by saying again that I think the literature needs more papers covering topics like this, but they need to be addressed in at least the depth available via my quick google search. Please motivate the design of your synthesis filter, show that it is in some sense the correct filter to choose: optimal for some metric, or with artefacts below the noise floor for plausible observations, or at least theoretically motivated somehow. I would be delighted to have a solid PFB inversion process in the formal literature, and would like to see the authors resubmit after a more careful exploration or justification of the filter choice.
